<%include partials/header%>
	
	<title>Map</title>
	<link rel="stylesheet" type="text/css" href="/CSS/map.css">
</head>
<body>
	<%for(var i=0;i<errorMessages.length;++i){%>
	<h1><%=errorMessages[i];%></h1>
	<%}%>

	<%var position=[];%>
	<%for(var i=0;i<locations.length;++i){%>
	<%position.push(locations[i]);%>
	<%}%>

	<div class="container">
	    <div class="row">
	        <div class="col-lg-9 col-md-12 col-sm-12 border-top-bottom custom-padding">
	              <div id="click-box" class="autocomplete">
	                <input  autocomplete="off" type="text" placeholder="Search Locations" id="filter_users">
	                    <ul id="users-list" class="z-index-99">

	                    </ul>
	              </div>
	        </div>
	        <!--<div class="col-lg-3 border-top-bottom custom-padding">
	        </div>-->
	    </div>  
	    <div class="row">
	        <div class="col-lg-9 col-sm-12 col-sm-12 no-pad-rt">
	            <div id="map">
	                <p>
	                test
	                </p>
	            </div>
	        </div>
	        <div class="col-lg-3 col-md-12 col-sm-12 pre-scrollable border-bottom list-stores">
	            <ul id="store-locations">
	                
	                
	                
	            </ul>

	        </div>

	    </div>
	</div>

	
</body>
<script>
	var clientPositions=<%-JSON.stringify(position)%>;
	console.log(clientPositions);

function initMap() {
	var infoWindow = new google.maps.InfoWindow();

	map = new google.maps.Map(document.getElementById('map'), {
		center:clientPositions[0].position,
		zoom: 4
	});

	for(var i=0;i<clientPositions.length;++i)
	{
		marker = new google.maps.Marker({
			position:clientPositions[i].position,
	        map:map,
	        title:clientPositions[i].name,
            address:clientPositions[i].address
		});
		 google.maps.event.addListener(marker, 'click', function(){
                infoWindow.setContent("<div class='custom-padding-5'><h4>"+this.title+"</h4>"+
                                      "<p>"+this.address+"</p>"+
                                      "<button value='2' class='main-color btn' onclick='getDirections("+'"'+this.address+'"'+")'>Directions</button></div>");
                infoWindow.open(map, this);
                //window.location.href = this.url;
            
            });

	}

}
function getDirections(address)
{
    window.location.href = "https://www.google.com/maps/search/"+address;
}
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCJyl_DjWAyQrgaRq_xAQjhPb22zUoi_xw&libraries=places&callback=initMap" async defer></script>

<%include partials/footer%>